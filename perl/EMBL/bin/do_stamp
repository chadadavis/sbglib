#!/usr/bin/env perl

use warnings;
use Carp;

use EMBL::STAMP;

################################################################################


my $dom = shift;
unless ($dom) {
    carp "Please specify as file of stamp formatted domains.\n";
    return;
}
# Read input domains into %DOM hash
my $in = new EMBL::DomainIO(-file=>$dom);
my @doms;
while (my $dom = $in->next_domain) {
    push @doms, $dom;
}

my @stamped = do_stamp(\@doms);

stampprint(\@stamped);

exit;

################################################################################

sub stampprint {
    my ($doms, $order, $fh) = @_;
    $fh ||= \*STDOUT;

    print $fh "%TRANS_BEGIN\n";

    # Reorder domains (using stampid field)
    $doms = reorder($doms, $order, 'stampid') if $order;

    my $tmpout = new EMBL::DomainIO(-fh=>$fh);
    $tmpout->write($_) for @$doms;

    print $fh "%TRANS_END\n";
}

################################################################################

__END__

